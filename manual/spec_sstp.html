<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="robots" content="INDEX,FOLLOW">
<meta name="author" content="UKADOC Project">
<meta name="keywords" content="ukadoc,ukagaka">
<title>UKADOC Project SSTP/1.x</title>
<link rel="stylesheet" href="list.css" />
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<script src="https://cdn.jsdelivr.net/gh/ukatech/jsstp-lib@v3.1.1.2/dist/jsstp.min.js"></script>
</head>
<body>
	<h1 id="page-title">SSTP/1.x</h1>
	<nav class="menu-header">
		<table>
			<tbody>
				<tr>
					<th>Return to top page</th>
					<td colspan="2">
						<ul>
							<li><a href="https://ukagakadreamteam.github.io/ukadoc/manual/index.html">INDEX</a></li>
						</ul>
					</td>
				</tr>
			</tbody>
			<tbody>
				<tr>
					<th rowspan="6">Settings files</th>
					<th>Ghost</th>
					<td>
						<ul>
							<li><a href="./descript_ghost.html">descript.txt</a></li>
						</ul>
					</td>
				</tr>
				<tr>
					<th>Shell</th>
					<td>
						<ul>
							<li><a href="./descript_shell.html">descript.txt</a></li>
							<li><a href="./descript_shell_surfaces.html">surfaces.txt</a></li>
							<li><a href="./descript_shell_surfacetable.html">surfacetable.txt</a></li>
						</ul>
					</td>
				</tr>
				<tr>
					<th>Balloon</th>
					<td>
						<ul>
							<li><a href="./descript_balloon.html">descript.txt</a></li>
							<li><a href="./descript_balloon.html#balloonsoption">balloon(s/k)*s.txt</a></li>
						</ul>
					</td>
				</tr>
				<tr>
					<th>Plugin</th>
					<td>
						<ul>
							<li><a href="./descript_plugin.html">descript.txt</a></li>
						</ul>
					</td>
				</tr>
				<tr>
					<th>Headline</th>
					<td>
						<ul>
							<li><a href="./descript_headline.html">descript.txt</a></li>
						</ul>
					</td>
				</tr>
				<tr>
					<th>Install</th>
					<td>
						<ul>
							<li><a href="./descript_install.html">install.txt</a></li>
							<li><a href="./descript_install.html#delete.txt">delete.txt</a></li>
							<li><a href="./descript_install.html#developer_options.txt">developer_options.txt</a></li>
						</ul>
					</td>
				</tr>
			</tbody>
			<tbody>
				<tr>
					<th>SakuraScript</th>
					<td colspan="2">
						<ul>
							<li><a href="./list_sakura_script.html">Sakura Script</a></li>
							<li><a href="./list_propertysystem.html">Property System</a></li>
						</ul>
					</td>
				</tr>
			</tbody>
			<tbody>
				<tr>
					<th rowspan="2">Events</th>
					<th>SHIORI</th>
					<td>
						<ul>
							<li><a href="./list_shiori_event.html">SHIORI Event</a></li>
							<li><a href="./list_shiori_event_ex.html">SHIORI Event (External)</a></li>
							<li><a href="./list_shiori_resource.html">SHIORI Resource</a></li>
						</ul>
					</td>
				</tr>
				<tr>
					<th>PLUGIN</th>
					<td>
						<ul>
							<li><a href="./list_plugin_event.html">PLUGIN Event</a></li>
						</ul>
					</td>
				</tr>
			</tbody>
			<tbody>
				<tr>
					<th>Standards</th>
					<td colspan="2">
						<ul>
							<li><a href="./spec_shiori3.html">SHIORI/3.0</a></li>
							<li><a href="./spec_sstp.html">SSTP/1.x</a></li>
							<li><a href="http://www.boreas.dti.ne.jp/~sdn/saori.html">SAORI/1.0</a> (External site)</li>
							<li><a href="./spec_plugin.html">PLUGIN/2.0</a></li>
							<li><a href="./spec_headline.html">HEADLINE/2.0</a></li>
							<li><a href="./spec_dll.html">DLL</a></li>
							<li><a href="./spec_fmo_mutex.html">FMO/MUTEX</a></li>
							<li><a href="./spec_web.html">Web-related</a></li>
						</ul>
					</td>
				</tr>
			</tbody>
		</table>
	</nav>
	<section class="navigation-bar">
		<h1>SSTP/1.x</h1>
		<section class="navigation-category">
			<h1>SSTP/1.x</h1>
			<ul>
				<li><a href="#sstp">Summary</a></li>
				<li><a href="#direct">Direct SSTP</a></li>
				<li><a href="#http">SSTP over HTTP</a></li>
				<li><a href="#req_res">request/response</a></li>
				<li><a href="#method_notify">Method: NOTIFY</a></li>
				<li><a href="#method_send">Method: SEND</a></li>
				<li><a href="#method_communicate">Method: COMMUNICATE</a></li>
				<li><a href="#method_execute">Method: EXECUTE</a></li>
				<li><a href="#method_give">Method: GIVE</a></li>
			</ul>
		</section>
	</section>
	<div class="categories">
		<section class="caption" id="notes_translation">
			<h1>Translated Document</h1>
			<div class="passage">
				<p>This document has been translated from the original Japanese by members of the Ukagaka Dream Team community.</p>
				<p>To see the original document, click <a href="https://ssp.shillest.net/ukadoc/manual/spec_sstp.html">here</a>.</p>
				<p>To submit corrections/updates, see <a href="https://github.com/Ukagaka-Dream-Team/ukadoc">our repository</a> to open an issue or find where to contact us.</p>
			</div>
		</section>
		<section class="category caption introduction" id="chapter0">
			<h1>SSTP/1.x</h1>
			<p>Reference: <a href="http://usada.sakura.vg/contents/sstp.html">SSTP</a> (External site)</p>
			<p>Currently, DirectSSTP relies heavily on Windows specifications and is not intended for implementation on other operating systems.
			<br />Since the IPC mechanism itself exists in other OSs, it would be desirable to define a separate specification.
			<br />If the specifications are decided, we will consider publishing them separately, so please contact <a href="https://github.com/ponapalt/ukadoc">Ukadoc Project</a>.</p>
		</section>
		<section class="category" id="sstp">
			<h1>Summary</h1>
			<p>SSTP is a general-purpose communication specification between ghosts. It can be used for simple SakuraScript playback, external event notification, etc.
			<br />Essentially, communication is done via TCP/IP. It listens on port 9801 or 9821 (SSP only), and when you send a request according to the SSTP protocol, the results of the processing are returned.
			<br />For security reasons, unless you change the settings, listening is now limited to localhost, and communication from outside the terminal is not possible. In the past, it also listened to port 11000, but this has now been discontinued as it was misidentified as communication by malware.
			<br />Although 7743 and 98901 are registered in <a href="https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=sakura+script">IANA's port number registry</a>, only 9801 is in actual operation.
			<br />There is a protocol with the same abbreviation, Secure Socket Tunneling Protocol, developed by Microsoft for VPN communication. There is no technical relationship between the two.
			<br />It does not take into account frequent communication that requires high performance, and does not have a keep-alive mechanism like HTTP. It disconnects at the end of each communication.</p>
		</section>
		
		
		<section class="category" id="direct">
			<h1>Direct SSTP</h1>
			<p>Direct SSTP is a communication specification that uses an IPC mechanism that is highly dependent on the OS. The protocol specifications are the same as (Socket) SSTP, but the purpose is to directly specify a ghost for lightweight communication without using TCP/IP, which requires relatively heavy processing.
			<br />Currently, the specifications have been determined only for Windows, and are as follows.</p>
			<section class="caption">
				<p>Send <a href="https://docs.microsoft.com/en-us/windows/win32/dataxchg/wm-copydata">WM_COPYDATA</a> using the SendMessage function (Post is not allowed)
				<br />hWnd in SendMessage = HWND of the target ghost, <a href="spec_fmo_mutex.html">obtained from FMO</a>
				<br />wParam = "own" HWND to which the reply is sent. The response is received by the HWND (window) that specified WM_COPYDATA.
				<br />lParam = pointer to <a href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/ns-winuser-copydatastruct">COPYDATASTRUCT</a>
				<br />copydatastruct.lpData = String according to SSTP protocol
				<br />copydatastruct.cbData = String length
				<br />copydatastruct.dwData = 9801
				<br />Note:
				<br />For safety reasons, the sender should provide a zero-terminated string in lpData, and it is desirable that cbData also include a zero-termination.
				<br />For safety reasons, the receiver should not expect zero-termination, and should always take cbData into consideration when processing.
				<br />The receiving side should treat the HWND that was specified as the communication target as being equivalent to the ghost that was specified to receive in the SSTP protocol, and give priority to that ghost as much as possible.
				<br />It is intended only for GUI applications that have at least one window on both the receiving and sending sides, and cannot be used with console applications.</p>
			</section>
		</section>
		
		
		<section class="category" id="http">
			<h1>SSTP over HTTP</h1>
			<p>SSTP over HTTP, implemented in SSP 2.6.32, is an extremely simple mechanism that plugs the SSTP request directly into the HTTP request message body, and returns the SSTP response directly in the HTTP response body.
			<br />It is intended to be used to more easily exchange SSTP communications when an application is built using JavaScript, such as Electron.
			<br />POST to /api/sstp/v1 using HTTP/1.1 with Content-Type: text/plain, to localhost:9801 (or a separately specified SSTP port).
			<br />The response is also returned as-is, with HTTP/1.1 200 OK Content-Type: text/plain.
			<br />Note that even if the SSTP response is an error, HTTP is 200 OK.
			<br />Note that the Content-Length header is required, and an error will result if it is not present.</p>
			
			<p><a href="http://localhost:9801/api/sstp/v1">Demo</a></p>
			
			<p>You can use <a href="https://github.com/ukatech/jsstp-lib/blob/master/docs/README_EN.md" target="_blank">the existing js library</a> to do SSTP over HTTP in js.</p>
			
			<p>Note: If the Origin header does not point to localhost, the request is forced to be treated as an SSTP request from a remote address. In that case, strong restrictions are placed on SakuraScript tags and SSTP methods that can be executed, and the SecurityLevel header is ignored.
			<br />This restriction is relaxed only when the Origin of HTTP is localhost and the SecurityLevel of SSTP is local.</p>
		</section>
		
		
		<section class="category" id="req_res">
			<h1>request/response</h1>
			<p>Like other protocols such as SHIORI, it is a proprietary protocol similar to HTTP.
			<br />It is mandatory to specify the Charset in the request; if it is not specified, an error will occur, or it will be interpreted as the charset specified by the OS standard.</p>

			<ul>
				<li>The line feed code is CR+LF</li>
				<li>The request ends with a blank line (combined with the previous line, (CR+LF)x2).</li>
				<li>Additional data may be added at the end of the response in cases such as EXECUTE. After the header, a blank line is inserted, followed by additional data, and then another blank line to end the response. If there is no additional data, the response may end with a blank line immediately after the header.</li>
				<li>For compatibility reasons, responses with additional data may not have any headers, including Charset, and only the additional data may be returned. In that case, it can be assumed that the charset is the same as that of the request.</li>
				<li>The SSTP version of the request and the response may be different. Do not make interpretations that depend on the version number.</li>
			</ul>

<h2>request</h2>

			<section class="caption">
				<h1>request sample</h1>
				<button id="runButton" style="display: none;">Run</button>

				<script>
				document.getElementById("runButton").addEventListener("click", function() {
					jsstp.SEND({
						Charset: "UTF-8",
						Sender: "SSTP Client",
						Script: "\\h\\s0Testing!\\u\\s[10]It's a test.",
						Option: "notranslate"
					})
				});
				document.addEventListener("DOMContentLoaded", async () => {
					if(await jsstp.available())
						document.getElementById("runButton").style.display = "inline";
				});
				</script>
<pre><!--
-->SEND SSTP/1.0
Charset: UTF-8
Sender: SSTP client
Script: \h\s0Test.\u\s[10]It's a test.
Option: notranslate

</pre>
				<h1>Headers common to each method of request</h1>
				<p>For method-specific information, check the explanations for each method below.</p>
				<dl>
					<dt>Charset</dt>
					<dd>Character code of the request. Should appear on the very first line.
					<br />UTF-8 is recommended if there is no particular reason to use otherwise.</dd>
					
					<dt>Sender</dt>
					<dd>A string indicating the sender. For example, "SSTP sender tool". For the COMMUNICATE method, the sending ghost's \0 name.</dd>
					
					<dt>SecurityLevel</dt>
					<dd>Specify the security level when processing with SHIORI or SakuraScript, either local or external.
					<br />Only valid for DirectSSTP or requests that are clearly local, such as 127.0.0.1.</dd>
					<br />SSTP over HTTP is always considered external, except when sent from html, etc., delivered from localhost.</dd>
					
					<dt>SecurityOrigin [SSP 2.6.59]</dt>
					<dd>A URL-like string that indicates the source server. The format is the same as the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Origin">HTTP header "Origin"</a>.
					<br />SecurityOrigin: null
					<br />SecurityOrigin: &lt;scheme&gt;://&lt;hostname&gt;
					<br />SecurityOrigin: &lt;scheme&gt;://&lt;hostname&gt;:&lt;port&gt;
					<br />scheme is usually one of http, https, or sstp. hostname is the name of or IP of the source server. port is the port on which replies can be accepted.
					<br />If not otherwise specified, it is assumed to be null.
					<br />For SSTP over HTTP, the contents of the HTTP Origin header are always set, and the SecurityOrigin in SSTP is ignored.
					</dd>

					<dt>Option</dt>
					<dd>Specify options for how SakuraScript executed by SSTP is handled.
					<br />Multiple options can be specified by separating them with commas. The strings that can be specified are as follows.
					<br />nodescript - Disable SSTP display on the balloon (disabled for SSTP from remote).
					<br />notranslate - No translate processing with OnTranslate or MAKOTO
					<br />nobreak - Do not interrupt the currently running script; wait until it finishes.</dd>
					
					<dt>ID</dt>
					<dd>"Owned SSTP", which is an ID sent by the <a href="list_shiori_event.html#uniqueid">SHIORI uniqueid</a> or <a href="spec_fmo_mutex.html">FMO's identification ID (SSP only)</a>. This SSTP is treated with the same priority as the ghost's internal processes, ignoring various security checks, locks, etc.
					<br />SecurityLevel specification becomes local, and it also enables forced interrupt of playback even in interrupt-disabled states such as \t.</dd>
					
					<dt>X-SSTP-PassThru-(arbitrary string)</dt>
					<dd>Header passed directly to SHIORI when communicating with the ghost side, such as NOTIFY.
					<br />Only minimal processing such as character code conversion is performed, and the (arbitrary string) part and contents are relayed as-is.</dd>
					
					<dt>HWnd</dt>
					<dd>For DirectSSTP only. Indicates the window handle to which the response should be returned.
					<br />The window handle (equivalent to a pointer) data is treated as an unsigned decimal integer and converted to a string.
					<br />If omitted, wParam of WM_COMMUNICATE.</dd>
					
					<dt>ReceiverGhostHWnd [SSP 2.5.57]</dt>
					<dd>For (Socket)SSTP only. Indicates the ghost's \0 window handle to which the request should be sent.
					<br />By specifying this, the ghost to be processed is fixed, and the same processing as DirectSSTP is possible via Socket.
					<br />If not found, an immediate error termination with 404 Not Found will occur.</dd>
					
					<dt>ReceiverGhostName [SSP 2.5.57]</dt>
					<dd>For (Socket)SSTP only. Indicates the \0 name of the ghost to which the request should be sent.
					<br />By specifying this, the ghost to be processed is fixed, and the same processing as DirectSSTP is possible via Socket. Name version of HWnd.
					<br />If not found, an immediate error termination with 404 Not Found will occur.</dd>
				</dl>

			</section>

			<h2>response</h2>

			<section class="caption">
				<h1>response sample (no data)</h1>
<pre><!--
-->SSTP/1.4 200 OK
Charset: UTF-8
Script: \h\s0Test.\u\s[10]It's a test.

</pre>
				<h1>response sample (data available)</h1>
<pre><!--
-->SSTP/1.4 200 OK
Charset: UTF-8
Script: \h\s0Test.\u\s[10]It's a test.

Additional data here

</pre>

				<h1>Headers common to each method of response</h1>
				<dl>
					<dt>Charset</dt>
					<dd>Character code of the request. Should appear on the very first line.
					<br />UTF-8 is recommended if there is no particular reason to use otherwise.
					<br />It may be intentionally omitted to solve compatibility problems. In such cases, it should be assumed that the character coode is the same as that of the request.</dd>
					<dt>X-SSTP-PassThru-(arbitrary string)</dt>
					<dd>Headers returned directly from SHIORI when communicating with the ghost side, such as NOTIFY.
					<br />Only minimal processing such as character code conversion is performed, and the (arbitrary string) part and contents are relayed as-is.</dd>
				</dl>

				<h1>Status code of response</h1>
				<p>As with HTTP, numbers in the 200s are accepted as normal, and others are errors.</p>
				<dl>
					<dt>200 OK</dt>
					<dd>Normal completion (with return value)</dd>
					<dt>204 No Content</dt>
					<dd>Normal completion (no return value)</dd>
					<dt>210 Break</dt>
					<dd>Executed but broken during script execution
					<br />※Only in very limited circumstances, such as SEND/1.x with Entry. Usually an immediate 200 or 204 return.</dd>
					<dt>400 Bad Request</dt>
					<dd>There is something wrong with the request that cannot be covered.</dd>
					<dt>404 Not Found ※SSP only</dt>
					<dd>The ghost specified by SSTP has not been installed or is not running.</dd>
					<dt>408 Request Timeout</dt>
					<dd>Timeout: When unable to communicate with the Ghost/SHIORI side (usually a very rare occurrence)</dd>
					<dt>409 Conflict</dt>
					<dd>Interrupts are disabled, such as via a \t tag, or other requests are being processed.</dd>
					<dt>413 Payload Too Large ※SSP only</dt>
					<dd>SSTP request was too long and was refused for processing.</dd>
					<dt>420 Refuse</dt>
					<dd>Reception was rejected due to ghost side settings.</dd>
					<dt>500 Internal Server Error ※SSP only</dt>
					<dd>The processing could not be completed due to some problem detected within the processing system.</dd>
					<dt>501 Not Implemented</dt>
					<dd>Could not be processed because it contained unimplemented commands, etc.</dd>
					<dt>503 Service Unavailable</dt>
					<dd>SSTP cannot be accepted due to internal circumstances within the processing system.</dd>
					<dt>505 Version Not Supported ※SSP only</dt>
					<dd>The SSTP version is incorrect (less than 1.0, more than 3.0, etc.)</dd>
					<dt>512 Invisible</dt>
					<dd>Ghost is not visible, e.g. because it is minimized, and nothing can be processed.</dd>
				</dl>
			</section>
		</section>


		<section class="category" id="method_notify">
			<h1>Method: NOTIFY</h1>

			<p>Methods for notifying ghosts of events.
			<br />Event header = corresponds to SHIORI/3.0 ID, Reference* remains the same.</p>

			<section class="caption">
				<h1>Event notification only sample (NOTIFY/1.0)</h1>
<pre><!--
-->NOTIFY SSTP/1.0
Charset: UTF-8
Sender: Media Player
Event: OnMusicPlay
Reference0: Wings of Freedom
Reference1: Linked Horizon

</pre>

			</section>

			<p>If the ghost does not respond to the specified event ID, you can specify an "insurance" script to play.
			<br />In such a case, if an IfGhost header is specified, the Script header immediately following is treated as a script exclusively for the specified ghost.</p>

			<section class="caption">
				<h1>Sample with insurance response (NOTIFY/1.1)</h1>
<pre><!--
-->NOTIFY SSTP/1.1
Charset: UTF-8
Sender: Media Player
Event: OnMusicPlay
Reference0: Bow and arrow of red lotus
Reference1: Linked Horizon
IfGhost: Emily,Teddy
Script: \0\s[6]That day, Emily recalled...\n\s[7]I haven't eaten a potato yet today!\1\s[11]Why did you bother to remember now?
IfGhost: ラーシェ,ティセ
Script: \0\s[3]Even though he's a giant, he's only a few train cars tall.\1\s[14]When it stands up vertically, I think it's big indeed.

</pre>
				<h1>request specific header</h1>
				<dl>
					<dt>Event</dt>
					<dd>Event ID. In SHIORI/3.0, it is treated as an ID header specification.</dd>
					<dt>Reference*</dt>
					<dd>Reference header of the event, which is passed to SHIORI after minimal processing such as character code conversion.</dd>
					<dt>Script</dt>
					<dd>SakuraScript to be played if the event is not responded to.</dd>
					<dt>IfGhost</dt>
					<dd>If you specify a ghost name in the format "\0 side name, \1 side name", the Script header that comes immediately after is treated as dedicated to that specific ghost.
					<br />If there is a Script header that is not immediately after IfGhost, it will be the Script for default processing when IfGhost is not applicable.
					<br />If omitted, the same Script header is played for all ghosts.
					<dt>Option</dt>
					<dd>Specify options for how SakuraScript executed by SSTP and specified events are handled.
					<br />Multiple strings can be specified by separating them with commas. The NOTIFY-specific parts of the specified strings are as follows.
					<br />notify: Force the event to be sent as NOTIFY. Also, the insurance script is forced to treat the event the same as if it were <a href="spec_shiori3.html#request">returned with a ValueNotify header</a>. [SSP 2.6.76]</dd>
				</dl>
				<h1>response specific header</h1>
				<dl>
					<dt>Script</dt>
					<dd>Script played as a result of event notification. Currently only SSP is supported.</dd>
				</dl>
			</section>
		</section>


		<section class="category" id="method_send">
			<h1>Method: SEND</h1>
			<p>(To be written)</p>
			<section class="caption">
				<h1>request-specific header</h1>
				<dl>
					<dt>Option</dt>
					<dd>Specify options for how SakuraScript executed by SSTP and specified events are handled.
					<br />Multiple strings can be specified by separating them with commas. The SEND-specific parts of the specified strings are as follows.
					<br />notify: Scripts are forced to be treated the same as if they were <a href="spec_shiori3.html#request">returned with a ValueNotify header</a>. [SSP 2.6.76]</dd>
				</dl>
			</section>
		</section>


		<section class="category" id="method_communicate">
			<h1>Method: COMMUNICATE</h1>
			
			<p>Using the COMMUNICATE method, you can give an arbitrary string to the ghost from the outside and have it react.
			<br />Basically, the reaction is the same as using the communication box inside the ghost, but since it is SSTP, it may not be accepted by the ghost.</p>
			
			<section class="caption">
				<h1>Simple COMMUNICATE (COMMUNICATE/1.1)</h1>
<pre><!--
-->COMMUNICATE SSTP/1.1
Charset: UTF-8
Sender: User
Sentence: Good morning.

</pre>
			</section>

			<p>Communicate can be sent and received repeatedly between SSTP servers (≒ ghosts).
			<br />When sending with response Reference0 of SHIORI/3.0, the timing for sending SSTP is when SakuraScript has finished playing.
			<br />This makes it possible to set up a process in which ghosts that are running simultaneously have a conversation with each other.</p>

			<section class="caption">
				<h1>Ghost to ghost communication (COMMUNICATE/1.2)</h1>

<pre><!--
-->COMMUNICATE SSTP/1.2
Charset: UTF-8
Sender: Emily
HWnd: 28236
Sentence: \0\s[5]Charaaaan! My name is Emily!\nI still have some room in my stomach...?\1\s[11]If you say that, won't you gain weight again?
Surface: 5,11
Reference0: Please give me a sweet potato
Reference1: Give me a lot
Reference2: Give it to me now

</pre>

				<h1>request specific header</h1>
				<dl>
					<dt>Reference*</dt>
					<dd>Communicate extended information. In SHIORI/3.0, it is stored in Reference2 or later. SSTP Reference0 = SHIORI Reference2.</dd>
					<dt>Surface</dt>
					<dd>Surface numbers of \0 and \1 at the time the sender ghost sends the communication (≒ at the end of the script execution).
					<br />Passed as Surface header in OnCommunicate event.</dd>
					<dt>Option</dt>
					<dd><em class="specsign">[Old specification]</em>When "substitute" is specified, \1 speaks the contents of Sentence. ※Not implemented in SSP.</dd>
				</dl>
			</section>
		</section>


		<section class="category" id="method_execute">
			<h1>Method: EXECUTE</h1>
			<p>Using the EXECUTE method, you can obtain various information about ghosts and execute various commands that do not rely on SakuraScript.
			<br />Execution of this method will not cause the ghost to speak, but its internal state may be rewritten.</p>
			
			<section class="caption">
				<h1>EXECUTE sample</h1>
<pre><!--
-->EXECUTE SSTP/1.1
Charset: UTF-8
Sender: SSTP Client
Command: GetName

</pre>
				<h1>request specific header</h1>
				<dl>
					<dt>Command or Command[param1,param2...]</dt>
					<dd>The command to be executed. The content to be executed and the information returned are described below.
					<br />After the brackets, specify the parameters to be passed to the command to be executed.</dd>
					
					<dt>Reference* [SSP]</dt>
					<dd>Parameters can also be specified in the header of Reference0~ instead of specifying them in brackets.</dd>
				</dl>
			</section>
			
			<p>See below for the strings that can be specified in the Command header and the results returned by the "additional data" in the response.</p>
			
			<section class="caption">
				<h1>Commands that can be specified in the Command header, and additional data that will be returned</h1>
				<dl>
					<dt>GetName</dt>
					<dd>(\0 name),(\1 name) of running ghosts, separated by commas</dd>
					<textarea type="text" id="GetNameResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetNameResultTextBox").style.display = "block";
								document.getElementById("GetNameResultTextBox").value = (await jsstp.GetName()).text_content;
							} else {
								document.getElementById("GetNameResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetNames [SSP]</dt>
					<dd>List of the \0 names of currently installed ghosts. Newline delimited. Terminated by a blank line.</dd>
					<textarea type="text" id="GetNamesResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetNamesResultTextBox").style.display = "block";
								document.getElementById("GetNamesResultTextBox").value = (await jsstp.GetNames()).text_content;
							} else {
								document.getElementById("GetNamesResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetFMO [SSP 2.5.57] [Restricted in Remote]</dt>
					<dd>Obtain information equivalent to the contents of the <a href="spec_fmo_mutex.html">FMO</a>.
					<br />However, this differs from the original FMO (which is shared by a group of concurrently running applications), as it is limited to the internal management of applications that communicate using SSTP.
					<br />It is mainly used in console applications that do not have a window and cannot send Direct SSTP, and is used to implement functions equivalent to Direct SSTP by utilizing the ReceiverGhostHWnd header with Socket SSTP only.
					<br />Newline delimited, terminated by a blank line.
					<br />In the case of a remote request, each path information is omitted, and the header and hwnd are replaced with a dummy.</dd>
					<textarea type="text" id="GetFMOResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetFMOResultTextBox").style.display = "block";
								document.getElementById("GetFMOResultTextBox").value = (await jsstp.GetFMO()).text_content;
							} else {
								document.getElementById("GetFMOResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetGhostName [SSP]</dt>
					<dd>Name of the running ghost (name in descript.txt)</dd>
					<textarea type="text" id="GetGhostNameResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetGhostNameResultTextBox").style.display = "block";
								document.getElementById("GetGhostNameResultTextBox").value = (await jsstp.GetGhostName()).text_content;
							} else {
								document.getElementById("GetGhostNameResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetShellName [SSP]</dt>
					<dd>Name of the shell currently in use by the running ghost</dd>
					<textarea type="text" id="GetShellNameResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetShellNameResultTextBox").style.display = "block";
								document.getElementById("GetShellNameResultTextBox").value = (await jsstp.GetShellName()).text_content;
							} else {
								document.getElementById("GetShellNameResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetBalloonName [SSP]</dt>
					<dd>Name of the balloon currently in use by the running ghost</dd>
					<textarea type="text" id="GetBalloonNameResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetBalloonNameResultTextBox").style.display = "block";
								document.getElementById("GetBalloonNameResultTextBox").value = (await jsstp.GetBalloonName()).text_content;
							} else {
								document.getElementById("GetBalloonNameResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetVersion</dt>
					<dd>Baseware (running software) version</dd>
					<textarea type="text" id="GetVersionResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetVersionResultTextBox").style.display = "block";
								document.getElementById("GetVersionResultTextBox").value = (await jsstp.GetVersion()).text_content;
							} else {
								document.getElementById("GetVersionResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetGhostNameList [SSP 2.6.53]</dt>
					<dd>Newline-separated list of all ghost names (names in descript.txt) recognized by SSP.</dd>
					<textarea type="text" id="GetGhostNameListResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetGhostNameListResultTextBox").style.display = "block";
								document.getElementById("GetGhostNameListResultTextBox").value = (await jsstp.GetGhostNameList()).text_content;
							} else {
								document.getElementById("GetGhostNameListResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetShellNameList [SSP 2.6.53]</dt>
					<dd>Newline-separated list of all shell names (names in descript.txt) recognized by the running ghost.</dd>
					<textarea type="text" id="GetShellNameListResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetShellNameListResultTextBox").style.display = "block";
								document.getElementById("GetShellNameListResultTextBox").value = (await jsstp.GetShellNameList()).text_content;
							} else {
								document.getElementById("GetShellNameListResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetBalloonNameList [SSP 2.6.53]</dt>
					<dd>Newline-separated list of all balloon names (names in descript.txt) recognized by SSP.</dd>
					<textarea type="text" id="GetBalloonNameListResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetBalloonNameListResultTextBox").style.display = "block";
								document.getElementById("GetBalloonNameListResultTextBox").value = (await jsstp.GetBalloonNameList()).text_content;
							} else {
								document.getElementById("GetBalloonNameListResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetHeadlineNameList [SSP 2.6.53]</dt>
					<dd>Newline-separated list of all headline names (names in descript.txt) recognized by SSP.</dd>
					<textarea type="text" id="GetHeadlineNameListResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetHeadlineNameListResultTextBox").style.display = "block";
								document.getElementById("GetHeadlineNameListResultTextBox").value = (await jsstp.GetHeadlineNameList()).text_content;
							} else {
								document.getElementById("GetHeadlineNameListResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetPluginNameList [SSP 2.6.53]</dt>
					<dd>Newline-separated list of all plugin names (names in descript.txt) recognized by SSP.</dd>
					<textarea type="text" id="GetPluginNameListResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								document.getElementById("GetPluginNameListResultTextBox").style.display = "block";
								document.getElementById("GetPluginNameListResultTextBox").value = (await jsstp.GetPluginNameList()).text_content;
							} else {
								document.getElementById("GetPluginNameListResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>GetShortVersion [SSP 2.6.53]</dt>
					<dd>Baseware (running software) version (period-separated version number only).<br />
					You can check if it is the latest version by a simple comparison with ssp.full.version in <a href="https://ssp.shillest.net/archive/version.json">version.json</a>.</dd>
					<textarea type="text" id="GetShortVersionResultTextBox" style="display: none; width: 358px; height: 106px;">
					</textarea>
					<script>
						document.addEventListener("DOMContentLoaded", async () => {
							if (await jsstp.available()) {
								const version = await jsstp.GetShortVersion();
								document.getElementById("GetShortVersionResultTextBox").style.display = "block";
								document.getElementById("GetShortVersionResultTextBox").value = version.text_content;
								let response = await fetch("https://ssp.shillest.net/archive/version.json");
								const json = await response.json();
								const latestVersion = json.ssp.full.version;
								document.getElementById("GetShortVersionResultTextBox").style.color = (version == latestVersion) ? "green" : "red";
							} else {
								document.getElementById("GetShortVersionResultTextBox").style.display = "none";
							}
						});
					</script>
					
					<dt>Quiet [Not supported in Remote]</dt>
					<dd>Perform a Restore or remain silent until 16 seconds have elapsed. No additional data (status code 200 successful)</dd>
					
					<dt>Restore</dt>
					<dd>Quiet is cancelled. No additional data (status code 200 successful)</dd>
					
					<dt>CompressArchive [SSP] [Not supported in Remote]</dt>
					<dd>Compresses a group of files in a specified folder into a compressed file.
					<br />Note that no response will be returned until the process is completed.
					<br />Parameter 0: Compressed file name
					<br />Parameter 1: Full path of the folder to be compressed
					<br />No additional data (status code 200 successful)</dd>
					
					<dt>ExtractArchive [SSP] [Not supported in Remote]</dt>
					<dd>Decompresses the specified compressed file.
					<br />Note that no response will be returned until the process is completed.
					<br />Parameter 0: Compressed file name
					<br />Parameter 1： Full path of the folder to unzip to
					<br />No additional data (status code 200 successful)</dd>

					<dt>DumpSurface [SSP 2.5.98] [Not supported in Remote]</dt>
					<dd>Outputs a composited surface image to the specified directory. Parameters are the same as <a href="list_sakura_script.html#_!_execute,dumpsurface,directory,scope_ID,surface_list_">\![execute,dumpsurface]</a>.
					<br />Note that no response will be returned until the process is completed.
					<br />No additional data (status code 200 successful)</dd>

					<dt>MoveAsync [SSP] [Not supported in Remote]</dt>
					<dd>Perform the same thing as <a href="list_sakura_script.html#notes_move">\![moveasync]</a> without SakuraScript. The method of specifying parameters is the same as the SakuraScript version.
					<br />Move without async cannot be performed because the response cannot be returned before the SSTP timeout, and it will cause a deadlock.
					<br />No additional data (status code 200 successful)</dd>
					
					<dt>SetTrayIcon [SSP] [Not supported in Remote]</dt>
					<dd>Perform the same thing as <a href="list_sakura_script.html#_!_set,trayballoon,option,option,option..._">\![set,tasktrayicon]</a> without SakuraScript. The method of specifying parameters is the same as the SakuraScript version.
					<br />No additional data (status code 200 successful)</dd>
					
					<dt>SetTrayBalloon [SSP] [Not supported in Remote]</dt>
					<dd>Perform the same thing as <a href="list_sakura_script.html#_!_set,trayballoon,option,option,option..._">\![set,trayballoon]</a> without SakuraScript. The method of specifying parameters is the same as the SakuraScript version.
					<br />No additional data (status code 200 successful)</dd>
					
					<dt>SetProperty [SSP] [Not supported in Remote]</dt>
					<dd>Writes values to the <a href="list_propertysystem.html">property system</a>.
					<br />Parameter 0: Property name
					<br />Parameter 1: Value to be set
					<br />No additional data (status code 200 successful)</dd>
					
					<dt>GetProperty [SSP]</dt>
					<dd>Read values from the <a href="list_propertysystem.html">property system</a>.
					<br />Parameter 0: Property name
					<br />Additional data is the value of the acquired property.</dd>
					
					<dt>SetCookie</dt>
					<dd>Writes to the general data storage area, which is saved for each client name specified in Sender.
					<br />It is intended to be used similarly to browser "cookies".
					<br />Parameter 0: Name of cookie
					<br />Parameter 1: Value to be set
					<br />No additional data (status code 200 successful)</dd>
					
					<dt>GetCookie</dt>
					<dd>Read from the general data storage area, which is saved for each client name specified in Sender.
					<br />Parameter 0: Name of cookie
					<br />Additional data is the value of the cookie obtained.</dd>
				</dl>
			</section>
		</section>


		<section class="category" id="method_give">
			<h1>Method: GIVE</h1>
			<p><em class="specsign">[Old specification]</em> Methods for giving various data to ghost to be processed or reacted to.
			<br />This is a very old specification and there is no point in using it now. Please use NOTIFY or COMMUNICATE.</p>
			
			<section class="caption">
				<h1>request sample</h1>
<pre><!--
-->GIVE SSTP/1.1
Charset: UTF-8
Sender: SSTP client
Document: First, water. Then the powder.

</pre>

<pre><!--
-->GIVE SSTP/1.1
Charset: UTF-8
Sender: SSTP client
Song: Sasebo no Shigure

</pre>

				<h1>request specific header</h1>
				<dl>
					<dt>Document</dt>
					<dd>Document (generic string)<br />
					In SHIORI/3.0, it is treated the same as a user communicate, and the OnCommunicate event is fired.</dd>
					<dt>Song</dt>
					<dd>Name of song.<br />
					In SHIORI/3.0, the OnMusicPlay event occurs, and Reference0 becomes the string specified in the Song header.</dd>
				</dl>
			</section>
		</section>


	</div>
</body>
</html>
